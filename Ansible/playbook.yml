---
- name: Deploy dockered app_php
  hosts: all
  any_errors_fatal: true
  become: yes
---
# tasks
tasks:
- name: Install Docker
  apt:
    name: docker.io
    state: latest  
- name: Install Docker Compose
  apt:
    name: docker-compose
    state: latest
  
- name: Restart service
  ansible.builtin.service:
    name: "{{ service_name }}"
      
- name: Copy docker-compose.yml file
  copy:
    src: files/docker-compose.yml
    dest: /home/ubuntu/docker-compose.yml
---
- name: Generate Nginx configuration file from template
  template:
    src: templates/nginx.conf.j2
    dest: /etc/nginx/conf.d/nginx_php.conf
  notify:
    - restart nginx
---
- name: restart nginx
  service:
    name: nginx
    state: restarted
    
 - name: nginx systemd
  systemd:
    name: nginx
    enabled: yes
    state: started
